{% extends 'base.html' %}
{% load static %}

{% block title %}Ficha de Obra | MARC21 Musical{% endblock %}

{% block content %}
<div class="container mt-4">
  <div class="card shadow-sm">
    <div class="card-header bg-light d-flex justify-content-between align-items-center">
      <h5 class="mb-0 fw-bold">
        üéº Ficha de Obra
      </h5>
      <a href="{% url 'listar_obras' %}" class="btn btn-outline-secondary btn-sm">
        <i class="bi bi-arrow-left"></i> Volver
      </a>
    </div>

    <div class="card-body">
      <!-- ======================== -->
      <!-- Informaci√≥n general -->
      <!-- ======================== -->
      <table class="table table-bordered">
        <tbody>
          <tr><th>N√∫mero de Control</th><td>{{ obra.num_control }}</td></tr>
          <tr><th>Tipo de Registro</th><td>{{ obra.tipo_registro }}</td></tr>
          <tr><th>Nivel Bibliogr√°fico</th><td>{{ obra.nivel_bibliografico }}</td></tr>
          <tr><th>Centro Catalogador</th><td>{{ obra.centro_catalogador }}</td></tr>
          <tr><th>Tonalidad</th><td>{{ obra.tonalidad_384|default:"No especificada" }}</td></tr>
          <tr><th>Clasificaci√≥n</th><td>{{ obra.clasificacion_092|default:"Sin clasificaci√≥n" }}</td></tr>
        </tbody>
      </table>

      <!-- ======================== -->
      <!-- BLOQUE 0XX -->
      <!-- ======================== -->
      <h5 class="text-primary mt-4">üìò Bloque 0XX ‚Äì Identificadores y C√≥digos</h5>
      <hr>
      <ul class="list-group mb-3">
        <li class="list-group-item">
          <strong>ISBN:</strong>
          {% if isbn %}
            <ul>{% for i in isbn %}<li>{{ obra.codigo_isbn }}</li>{% endfor %}</ul>
          {% else %}
            <em>No hay ISBN registrados.</em>
          {% endif %}
        </li>
        <li class="list-group-item">
          <strong>ISMN:</strong>
          {% if ismn %}
            <ul>{% for i in ismn %}<li>{{ obra.codigo_ismn }}</li>{% endfor %}</ul>
          {% else %}
            <em>No hay ISMN registrados.</em>
          {% endif %}
        </li>
        <li class="list-group-item">
          <strong>N√∫meros de editor:</strong>
          {% if numero_editor %}
            <ul>{% for n in numero_editor %}<li>{{ n.numero_editor }}</li>{% endfor %}</ul>
          {% else %}
            <em>No hay n√∫meros de editor registrados.</em>
          {% endif %}
        </li>
        <li class="list-group-item">
          <strong>Incipits musicales:</strong>
          {% if incipits %}
            <ul>{% for inc in incipits %}<li>{{ inc.incipit_titulo }}</li>{% endfor %}</ul>
          {% else %}
            <em>No hay incipits musicales registrados.</em>
          {% endif %}
        </li>
        <li class="list-group-item">
          <strong>C√≥digos de lengua:</strong>
          {% if codigo_lengua %}
            <ul>{% for c in codigo_lengua %}<li>{{ c.codigo }}</li>{% endfor %}</ul>
          {% else %}
            <em>No hay c√≥digos de lengua registrados.</em>
          {% endif %}
        </li>
        <li class="list-group-item">
          <strong>C√≥digos de pa√≠s/entidad:</strong>
          {% if codigos_pais_entidad %}
            <ul>{% for p in codigos_pais_entidad %}<li>{{ p.codigo }}</li>{% endfor %}</ul>
          {% else %}
            <em>No hay c√≥digos de pa√≠s registrados.</em>
          {% endif %}
        </li>
      </ul>

      <!-- ======================== -->
      <!-- BLOQUE 1XX -->
      <!-- ======================== -->
      <h5 class="text-primary mt-4">üéµ Bloque 1XX ‚Äì Autores y T√≠tulos Uniformes</h5>
      <hr>
      <ul class="list-group mb-3">
        <li class="list-group-item">
          <strong>Compositor(es):</strong>
          {% if compositor %}
            <ul>{% for c in compositor %}<li>{{ c.nombre_autor }}</li>{% endfor %}</ul>
          {% else %}
            <em>No hay compositores registrados.</em>
          {% endif %}
        </li>
        <li class="list-group-item">
          <strong>T√≠tulos Uniformes (130):</strong>
          {% if titulo_uniforme_130 %}
            <ul>{% for t in titulo_uniforme_130 %}<li>{{ t.titulo }}</li>{% endfor %}</ul>
          {% else %}
            <em>No hay t√≠tulos uniformes registrados.</em>
          {% endif %}
        </li>
      </ul>

      <!-- ======================== -->
      <!-- BLOQUE 7XX -->
      <!-- ======================== -->
      <h5 class="text-primary mt-4">üë• Bloque 7XX ‚Äì Relaciones y Entidades Vinculadas</h5>
      <hr>
      <ul class="list-group mb-3">
        <li class="list-group-item">
          <strong>Nombres Relacionados (700):</strong>
          {% if nombres_relacionados %}
            <ul>{% for n in nombres_relacionados %}<li>{{ n.nombre_persona }}</li>{% endfor %}</ul>
          {% else %}
            <em>No hay nombres relacionados.</em>
          {% endif %}
        </li>
        <li class="list-group-item">
          <strong>Entidades Relacionadas (710):</strong>
          {% if entidades_relacionadas %}
            <ul>{% for e in entidades_relacionadas %}<li>{{ e.nombre_entidad }}</li>{% endfor %}</ul>
          {% else %}
            <em>No hay entidades relacionadas.</em>
          {% endif %}
        </li>
        <li class="list-group-item">
          <strong>Otras Relaciones (787):</strong>
          {% if otras_relaciones %}
            <ul>{% for r in otras_relaciones %}<li>{{ r.descripcion_relacion }}</li>{% endfor %}</ul>
          {% else %}
            <em>No hay relaciones adicionales.</em>
          {% endif %}
        </li>
      </ul>

      <!-- ======================== -->
      <!-- BLOQUE 8XX -->
      <!-- ======================== -->
      <h5 class="text-primary mt-4">üìç Bloque 8XX ‚Äì Ubicaci√≥n y Recursos</h5>
      <hr>
      <ul class="list-group mb-3">
        <li class="list-group-item">
          <strong>Ubicaciones (852):</strong>
          {% if ubicaciones %}
            <ul>
              {% for u in ubicaciones %}
                <li>{{ u.institucion_persona }} ‚Äî {{ u.signatura_original|default:"sin signatura" }}</li>
              {% endfor %}
            </ul>
          {% else %}
            <em>No hay ubicaciones registradas.</em>
          {% endif %}
        </li>
        <li class="list-group-item">
          <strong>Recursos Digitales (856):</strong>
          {% if recursos %}
            <ul>
              {% for r in recursos %}
                <li>
                  {% if r.url %}
                    <a href="{{ r.url }}" target="_blank">{{ r.texto_enlace|default:r.url }}</a>
                  {% else %}
                    {{ r.texto_enlace }}
                  {% endif %}
                </li>
              {% endfor %}
            </ul>
          {% else %}
            <em>No hay recursos digitales disponibles.</em>
          {% endif %}
        </li>
      </ul>
    </div>
  </div>
</div>
{% endblock %}
