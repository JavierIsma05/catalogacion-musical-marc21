{% extends 'base.html' %}
{% load static %}
{% block title %}Registrar Obra | MARC21 Musical{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
  <div class="row">

    <!-- üî∏ COLUMNA IZQUIERDA -->
    <div class="col-md-9">
      <div class="card shadow-sm mb-4">
        <div class="card-header bg-success text-white">
          <h5 class="mb-0">Registro MARC21 Musical</h5>
        </div>
        <div class="card-body">
          <form method="POST">
            {% csrf_token %}

            <!-- üü© CABECERA O L√çDER -->
            <h5 class="text-primary" id="cabecera">Cabecera o L√≠der</h5>
            <div class="marc-block mb-4">
              <div class="row mb-2">
                <div class="col-md-6">
                  <label>06 ‚Äì Tipo de registro</label>
                  {{ form.tipo_registro }}
                </div>
                <div class="col-md-6">
                  <label>07 ‚Äì Nivel bibliogr√°fico</label>
                  {{ form.nivel_bibliografico }}
                </div>
              </div>
            </div>

            <!-- üü® BLOQUE 0XX -->
            <h5 class="text-primary mt-4" id="bloque-0xx">Bloque 0XX ‚Äì Campos de longitud variable</h5>

            <!-- 020 ## N√∫mero Internacional Normalizado para Libros -->
            <div class="marc-block mb-4">
              <h6><strong>020 ##</strong> ‚Äî N√∫mero Internacional Normalizado para Libros (ISBN)</h6>
              <div class="row align-items-center mb-2">
                <div class="col-md-4">
                  <label>$a ISBN</label>
                </div>
                <div class="col-md-8">
                  {{ form.isbn }}
                </div>
              </div>
            </div>

            <!-- 024 2# Otros identificadores normalizados -->
            <div class="marc-block mb-4">
              <h6><strong>024 2#</strong> ‚Äî Otros identificadores normalizados (ISMN)</h6>
              <div class="row align-items-center mb-2">
                <div class="col-md-4"><label>$a ISMN</label></div>
                <div class="col-md-8">{{ form.ismn }}</div>
              </div>
            </div>

            <!-- 028 20 N√∫mero de editor -->
            <div class="marc-block mb-4">
              <h6><strong>028 20</strong> ‚Äî N√∫mero de editor o distribuidor</h6>
              <div class="row mb-2">
                <div class="col-md-4"><label>$a N√∫mero de editor</label></div>
                <div class="col-md-8">{{ form.numero_editor }}</div>
              </div>
              <div class="row">
                <div class="col-md-4"><label>Indicador</label></div>
                <div class="col-md-8">{{ form.indicador_028 }}</div>
              </div>
            </div>

            <!-- 031 ## Informaci√≥n del √≠ncipit musical -->
            <div class="marc-block mb-4">
              <h6><strong>031 ##</strong> ‚Äî Informaci√≥n del √≠ncipit musical</h6>
              <div class="row mb-2">
                <div class="col-md-4"><label>$a N¬∫ de obra</label></div>
                <div class="col-md-8">{{ form.incipit_num_obra }}</div>
              </div>
              <div class="row mb-2">
                <div class="col-md-4"><label>$b N¬∫ de movimiento</label></div>
                <div class="col-md-8">{{ form.incipit_num_movimiento }}</div>
              </div>
              <div class="row mb-2">
                <div class="col-md-4"><label>$c N¬∫ de pasaje</label></div>
                <div class="col-md-8">{{ form.incipit_num_pasaje }}</div>
              </div>
              <div class="row mb-2">
                <div class="col-md-4"><label>$d T√≠tulo o encabezamiento</label></div>
                <div class="col-md-8">{{ form.incipit_titulo }}</div>
              </div>
              <div class="row mb-2">
                <div class="col-md-4"><label>$m Voz/instrumento</label></div>
                <div class="col-md-8">{{ form.incipit_voz_instrumento }}</div>
              </div>
              <div class="row mb-2">
                <div class="col-md-4"><label>$p Notaci√≥n musical</label></div>
                <div class="col-md-8">{{ form.incipit_notacion }}</div>
              </div>
              <div class="row">
                <div class="col-md-4"><label>$u URL (√≠ncipit externo)</label></div>
                <div class="col-md-8">{{ form.incipit_url }}</div>
              </div>
            </div>

            <!-- 040 ## Fuente de catalogaci√≥n -->
            <div class="marc-block mb-4">
              <h6><strong>040 ##</strong> ‚Äî Fuente de catalogaci√≥n</h6>
              <div class="row">
                <div class="col-md-4"><label>$a Centro catalogador</label></div>
                <div class="col-md-8">{{ form.centro_catalogador }}</div>
              </div>
            </div>

            <!-- 041 0# C√≥digo de lengua -->
            <div class="marc-block mb-4">
              <h6><strong>041 0#</strong> ‚Äî C√≥digo de lengua</h6>
              <div class="row">
                <div class="col-md-4"><label>$a Idioma</label></div>
                <div class="col-md-8">{{ form.codigo_lengua }}</div>
              </div>
            </div>

            <!-- 044 ## C√≥digo del pa√≠s -->
            <div class="marc-block mb-4">
              <h6><strong>044 ##</strong> ‚Äî Pa√≠s de la entidad editora/productora</h6>
              <div class="row">
                <div class="col-md-4"><label>$a Pa√≠s</label></div>
                <div class="col-md-8">{{ form.codigo_pais }}</div>
              </div>
            </div>

            <!-- 092 ## Clasificaci√≥n local -->
            <div class="marc-block mb-4">
              <h6><strong>092 ##</strong> ‚Äî Clasificaci√≥n local</h6>
              <div class="row mb-2">
                <div class="col-md-4"><label>$a Instituci√≥n</label></div>
                <div class="col-md-8">{{ form.clasif_institucion }}</div>
              </div>
              <div class="row mb-2">
                <div class="col-md-4"><label>$b Proyecto</label></div>
                <div class="col-md-8">{{ form.clasif_proyecto }}</div>
              </div>
              <div class="row mb-2">
                <div class="col-md-4"><label>$c Pa√≠s</label></div>
                <div class="col-md-8">{{ form.clasif_pais }}</div>
              </div>
              <div class="row">
                <div class="col-md-4"><label>$d Ms/Imp</label></div>
                <div class="col-md-8">{{ form.clasif_ms_imp }}</div>
              </div>
            </div>

            <!-- üü¶ BLOQUE 1XX -->
            <h5 class="text-primary mt-4" id="bloque-1xx">Bloque 1XX ‚Äì Asientos principales (punto de acceso)</h5>

            <!-- 100 1# Compositor -->
            <div class="marc-block mb-4">
              <h6><strong>100 1#</strong> ‚Äî Compositor (NR)</h6>
              <div class="row mb-2">
                <div class="col-md-4"><label>$a Apellidos, Nombres</label></div>
                <div class="col-md-8">{{ form.compositor_apellidos_nombres }}</div>
              </div>
              <div class="row mb-2">
                <div class="col-md-4"><label>$d Coordenadas biogr√°ficas</label></div>
                <div class="col-md-8">{{ form.compositor_coordenadas_biograficas }}</div>
              </div>
              <div class="row mb-2">
                <div class="col-md-4"><label>$e Funci√≥n</label></div>
                <div class="col-md-8">{{ form.compositor_funcion }}</div>
              </div>
              <div class="row">
                <div class="col-md-4"><label>$j Autor√≠a</label></div>
                <div class="col-md-8">{{ form.compositor_autoria }}</div>
              </div>
            </div>

            <!-- 130 0# T√≠tulo uniforme -->
            <div class="marc-block mb-4">
              <h6><strong>130 0#</strong> ‚Äî T√≠tulo uniforme (punto de acceso principal) (NR)</h6>
              <div class="row mb-2">
                <div class="col-md-4"><label>$a T√≠tulo uniforme</label></div>
                <div class="col-md-8">{{ form.titulo_uniforme }}</div>
              </div>
              <div class="row mb-2">
                <div class="col-md-4"><label>$k Subencabezamiento de forma</label></div>
                <div class="col-md-8">{{ form.titulo_uniforme_subencabezamiento_forma }}</div>
              </div>
              <div class="row mb-2">
                <div class="col-md-4"><label>$m Medio de interpretaci√≥n</label></div>
                <div class="col-md-8">{{ form.titulo_uniforme_medio_interpretacion }}</div>
              </div>
              <div class="row mb-2">
                <div class="col-md-4"><label>$n N√∫mero de parte/secci√≥n</label></div>
                <div class="col-md-8">{{ form.titulo_uniforme_num_parte_seccion }}</div>
              </div>
              <div class="row mb-2">
                <div class="col-md-4"><label>$o Arreglo</label></div>
                <div class="col-md-8">{{ form.titulo_uniforme_arreglo }}</div>
              </div>
              <div class="row mb-2">
                <div class="col-md-4"><label>$p Nombre de parte/secci√≥n</label></div>
                <div class="col-md-8">{{ form.titulo_uniforme_nombre_parte_seccion }}</div>
              </div>
              <div class="row">
                <div class="col-md-4"><label>$r Tonalidad</label></div>
                <div class="col-md-8">{{ form.titulo_uniforme_tonalidad }}</div>
              </div>
            </div>

            <div class="d-flex gap-3 mt-4">
              <button type="submit" name="guardar_continuar" class="btn btn-success">
                Guardar y continuar editando
              </button>
              <button type="submit" name="guardar_cerrar" class="btn btn-primary">
                Guardar y cerrar
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- üü¶ TABLA DE OBRAS -->
      <div class="card shadow-sm mt-3">
        <div class="card-header bg-secondary text-white">
          <h6 class="mb-0">Obras registradas</h6>
        </div>
        <div class="card-body">
          <table class="table table-bordered table-striped mt-2">
            <thead class="table-success">
              <tr>
                <th>001 N¬∫ Control</th>
                <th>100 Compositor</th>
                <th>130 T√≠tulo uniforme</th>
                <th>020 ISBN</th>
                <th>024 ISMN</th>
                <th>044 Pa√≠s</th>
                <th>041 Idioma</th>
              </tr>
            </thead>
            <tbody>
              {% for obra in obras %}
              <tr>
                <td>{{ obra.num_control }}</td>
                <td>{{ obra.compositor_apellidos_nombres|default:"-" }}</td>
                <td>{{ obra.titulo_uniforme|default:"-" }}</td>
                <td>{{ obra.isbn|default:"-" }}</td>
                <td>{{ obra.ismn|default:"-" }}</td>
                <td>{{ obra.get_codigo_pais_display }}</td>
                <td>{{ obra.get_codigo_lengua_display }}</td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="7" class="text-center">No hay registros a√∫n.</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- üîπ COLUMNA DERECHA -->
    <div class="col-md-3">
      <div class="sidebar rounded shadow-sm p-3 bg-white">
        <h6 class="fw-bold mb-3">üìã Navegaci√≥n MARC21</h6>
        <a href="#cabecera" class="d-block mb-2 text-decoration-none">üü© Cabecera o L√≠der</a>
        <a href="#bloque-0xx" class="d-block mb-2 text-decoration-none">üü¶ Bloque 0XX - Campos variables</a>
        <a href="#bloque-1xx" class="d-block mb-2 text-decoration-none">üü¶ Bloque 1XX - Asientos principales</a>
        <hr>
        <h6 class="fw-bold mb-3">üéØ Acciones</h6>
        <a href="#" class="d-block mb-2 text-decoration-none">üíæ Guardar borrador</a>
        <a href="#" class="d-block mb-2 text-decoration-none">üîç Vista preliminar</a>
        <a href="#" class="d-block mb-2 text-decoration-none">‚ö†Ô∏è Validar registro</a>
      </div>
    </div>
  </div>
</div>
{% endblock %}
