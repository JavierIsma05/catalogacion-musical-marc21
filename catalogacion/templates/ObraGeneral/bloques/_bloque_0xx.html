{# ============================================ #}
{# BLOQUE 0XX - CAMPOS DE CONTROL #}
{# ============================================ #}

<!-- 020 - ISBN (Repetible) -->
<div class="card border-0 shadow-sm mb-5" id="bloque-0xx">
    <div class="card-body">
        <h2 class="section-title">020 - ISBN</h2>
        <div id="isbn-container">
            <div class="campo-repetible" data-campo="isbn-0">
                <div class="campo-header">
                    <span class="campo-label">ISBN #1</span>
                    <button type="button" class="btn btn-outline-danger btn-remove" onclick="eliminarCampo('isbn-0')">
                        <i class="bi bi-trash"></i> Eliminar
                    </button>
                </div>
                <div class="row g-2">
                    <div class="col-md-12">
                        <label class="subcampo-label">$a ISBN</label>
                        <input type="text" name="isbn_a_0" class="form-control" placeholder="978-0-123456-78-9">
                    </div>
                </div>
            </div>
        </div>
        <button type="button" class="btn btn-outline-primary btn-add-field" onclick="agregarISBN()">
            <i class="bi bi-plus-circle"></i> Agregar ISBN
        </button>
    </div>
</div>

<!-- 024 - ISMN (Repetible) -->
<div class="card border-0 shadow-sm mb-4">
    <div class="card-body">
        <h2 class="section-title">024 - ISMN (Número Internacional Normalizado de Música)</h2>
        <div id="ismn-container">
            <div class="campo-repetible" data-campo="ismn-0">
                <div class="campo-header">
                    <span class="campo-label">ISMN #1</span>
                    <button type="button" class="btn btn-outline-danger btn-remove" onclick="eliminarCampo('ismn-0')">
                        <i class="bi bi-trash"></i> Eliminar
                    </button>
                </div>
                <div class="row g-2">
                    <div class="col-md-12">
                        <label class="subcampo-label">$a ISMN</label>
                        <input type="text" name="ismn_a_0" class="form-control" placeholder="M-001-12345-6-7">
                    </div>
                </div>
            </div>
        </div>
        <button type="button" class="btn btn-outline-primary btn-add-field" onclick="agregarISMN()">
            <i class="bi bi-plus-circle"></i> Agregar ISMN
        </button>
    </div>
</div>

<!-- 028 - Número de Editor (Repetible) -->
<div class="card border-0 shadow-sm mb-4">
    <div class="card-body">
        <h2 class="section-title">028 - Número de Editor de Música</h2>
        <div id="numero-editor-container">
            <div class="campo-repetible" data-campo="numero-editor-0">
                <div class="campo-header">
                    <span class="campo-label">Número de Editor #1</span>
                    <button type="button" class="btn btn-outline-danger btn-remove" onclick="eliminarCampo('numero-editor-0')">
                        <i class="bi bi-trash"></i> Eliminar
                    </button>
                </div>
                <div class="row g-2 mb-2">
                    <div class="col-md-12">
                        <label class="subcampo-label">$a Número de Editor</label>
                        <input type="text" name="numero_editor_a_0" class="form-control" placeholder="Ej: B. & H. 8797">
                    </div>
                </div>
                <div class="row g-2">
                    <div class="col-md-6">
                        <label class="subcampo-label">Indicador 1 - Tipo de Número</label>
                        <select name="numero_editor_tipo_0" class="form-select">
                            {% for value, label in tipo_numero_editor %}
                            <option value="{{ value }}" {% if value == '2' %}selected{% endif %}>{{ value }} - {{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label class="subcampo-label">Indicador 2 - Control de Nota</label>
                        <select name="numero_editor_control_0" class="form-select">
                            {% for value, label in control_nota_editor %}
                            <option value="{{ value }}" {% if value == '0' %}selected{% endif %}>{{ value }} - {{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <button type="button" class="btn btn-outline-primary btn-add-field" onclick="agregarNumeroEditor()">
            <i class="bi bi-plus-circle"></i> Agregar Número de Editor
        </button>
    </div>
</div>

<!-- 031 - Incipit Musical (Repetible con URLs repetibles) -->
<div class="card border-0 shadow-sm mb-4">
    <div class="card-body">
        <h2 class="section-title">031 - Incipit Musical</h2>
        <div id="incipit-container">
            <div class="campo-repetible" data-campo="incipit-0">
                <div class="campo-header">
                    <span class="campo-label">Incipit #1</span>
                    <button type="button" class="btn btn-outline-danger btn-remove" onclick="eliminarCampo('incipit-0')">
                        <i class="bi bi-trash"></i> Eliminar
                    </button>
                </div>

                <div class="row g-2 mb-2">
                    <div class="col-md-4">
                        <label class="subcampo-label">$a Número de Obra</label>
                        <input type="number" name="incipit_a_0" class="form-control" placeholder="{{ incipit_defaults.numero_obra }}" value="{{ incipit_defaults.numero_obra }}" min="1">
                    </div>
                    <div class="col-md-4">
                        <label class="subcampo-label">$b Número de Movimiento</label>
                        <input type="number" name="incipit_b_0" class="form-control" placeholder="{{ incipit_defaults.numero_movimiento }}" value="{{ incipit_defaults.numero_movimiento }}" min="1">
                    </div>
                    <div class="col-md-4">
                        <label class="subcampo-label">$c Número de Pasaje</label>
                        <input type="number" name="incipit_c_0" class="form-control" placeholder="{{ incipit_defaults.numero_pasaje }}" value="{{ incipit_defaults.numero_pasaje }}" min="1">
                    </div>
                </div>

                <div class="row g-2 mb-2">
                    <div class="col-md-6">
                        <label class="subcampo-label">$d Título o Encabezamiento (opcional)</label>
                        <input type="text" name="incipit_d_0" class="form-control" placeholder="Ej: Aria, Allegro, Andante">
                    </div>
                    <div class="col-md-6">
                        <label class="subcampo-label">$m Voz/Instrumento</label>
                        <input type="text" name="incipit_m_0" class="form-control" placeholder="{{ incipit_defaults.voz_instrumento }}" value="{{ incipit_defaults.voz_instrumento }}">
                        <small class="text-muted">Predeterminado: {{ incipit_defaults.voz_instrumento }}</small>
                    </div>
                </div>

                <div class="row g-2 mb-3">
                    <div class="col-md-12">
                        <label class="subcampo-label">$p Notación Musical (opcional)</label>
                        <textarea name="incipit_p_0" class="form-control" rows="2" placeholder="Código de incipit musical (Plaine & Easie, MusicXML, ABC)"></textarea>
                    </div>
                </div>

                <!-- URLs repetibles para este incipit -->
                <div class="subcampo-group">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <label class="subcampo-label mb-0">$u URL Uniforme de Recursos</label>
                        <button type="button" class="btn btn-outline-primary btn-sm" onclick="agregarURLIncipit(0)">
                            <i class="bi bi-plus"></i> URL
                        </button>
                    </div>
                    <div id="incipit-0-urls">
                        <div class="mb-2" data-subcampo="url-0-0">
                            <div class="input-group input-group-sm">
                                <input type="url" name="incipit_u_0_0" class="form-control" placeholder="https://...">
                                <button type="button" class="btn btn-outline-danger" onclick="eliminarSubcampo('url-0-0')">
                                    <i class="bi bi-x"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <button type="button" class="btn btn-outline-primary btn-add-field" onclick="agregarIncipit()">
            <i class="bi bi-plus-circle"></i> Agregar Incipit
        </button>
    </div>
</div>

<!-- 040 - Fuente de Catalogación -->
<div class="card border-0 shadow-sm mb-4">
    <div class="card-body">
        <h2 class="section-title">040 - Fuente de Catalogación</h2>
        <div class="row g-3">
            <div class="col-md-6">
                <label class="form-label small">$a Centro Catalogador</label>
                <input type="text" name="centro_catalogador" class="form-control" value="UNL" placeholder="UNL" maxlength="10">
                <small class="text-muted">Predeterminado: UNL</small>
            </div>
        </div>
    </div>
</div>

<!-- 041 - Código de Lengua (Repetible con idiomas repetibles) -->
<div class="card border-0 shadow-sm mb-4">
    <div class="card-body">
        <h2 class="section-title">041 - Código de Lengua</h2>
        <div id="codigo-lengua-container">
            <div class="campo-repetible" data-campo="codigo-lengua-0">
                <div class="campo-header">
                    <span class="campo-label">Código de Lengua #1</span>
                    <button type="button" class="btn btn-outline-danger btn-remove" onclick="eliminarCampo('codigo-lengua-0')">
                        <i class="bi bi-trash"></i> Eliminar
                    </button>
                </div>

                <div class="row g-2 mb-3">
                    <div class="col-md-6">
                        <label class="subcampo-label">Indicador 1 - Código de Traducción</label>
                        <select name="codigo_lengua_ind1_0" class="form-select">
                            {% for value, label in indicacion_traduccion %}
                            <option value="{{ value }}" {% if value == '0' %}selected{% endif %}>{{ value }} - {{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label class="subcampo-label">Indicador 2 - Código de Fuente</label>
                        <select name="codigo_lengua_ind2_0" class="form-select">
                            {% for value, label in fuente_codigo %}
                            <option value="{{ value }}" {% if value == '#' %}selected{% endif %}>{{ value }} - {{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <!-- Idiomas repetibles -->
                <div class="subcampo-group">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <label class="subcampo-label mb-0">$a Código de Lengua del Texto/Banda Sonora</label>
                        <button type="button" class="btn btn-outline-primary btn-sm" onclick="agregarIdiomaObra(0)">
                            <i class="bi bi-plus"></i> Idioma
                        </button>
                    </div>
                    <div id="codigo-lengua-0-idiomas">
                        <div class="mb-2" data-subcampo="idioma-0-0">
                            <div class="input-group input-group-sm">
                                <select name="codigo_lengua_a_0_0" class="form-select form-select-sm">
                                    {% for value, label in codigos_idioma %}
                                    <option value="{{ value }}" {% if value == 'spa' %}selected{% endif %}>{{ label }}</option>
                                    {% endfor %}
                                </select>
                                <button type="button" class="btn btn-outline-danger" onclick="eliminarSubcampo('idioma-0-0')">
                                    <i class="bi bi-x"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <button type="button" class="btn btn-outline-primary btn-add-field" onclick="agregarCodigoLengua()">
            <i class="bi bi-plus-circle"></i> Agregar Código de Lengua
        </button>
    </div>
</div>

<!-- 044 - Código de País (Repetible) -->
<div class="card border-0 shadow-sm mb-4">
    <div class="card-body">
        <h2 class="section-title">044 - Código de País de Entidad Productora/Editora</h2>
        <div id="codigo-pais-container">
            <div class="campo-repetible" data-campo="codigo-pais-0">
                <div class="campo-header">
                    <span class="campo-label">Código de País #1</span>
                    <button type="button" class="btn btn-outline-danger btn-remove" onclick="eliminarCampo('codigo-pais-0')">
                        <i class="bi bi-trash"></i> Eliminar
                    </button>
                </div>
                <div class="row g-2">
                    <div class="col-md-12">
                        <label class="subcampo-label">$a Código de País</label>
                        <select name="codigo_pais_a_0" class="form-select">
                            {% for codigo, nombre in codigos_pais %}
                            <option value="{{ codigo }}" {% if codigo == 'ec' %}selected{% endif %}>{{ nombre }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <button type="button" class="btn btn-outline-primary btn-add-field" onclick="agregarCodigoPais()">
            <i class="bi bi-plus-circle"></i> Agregar Código de País
        </button>
    </div>
</div>

<!-- 092 - Clasificación Local -->
<div class="card border-0 shadow-sm mb-4">
    <div class="card-body">
        <h2 class="section-title">092 - Clasificación Local</h2>
        <div class="alert alert-info" role="alert">
            <i class="bi bi-info-circle"></i>
            <small>Los campos de este bloque se generan automáticamente a partir de otros campos. Se completan al guardar la obra.</small>
        </div>
        <div class="row g-3">
            <div class="col-md-6">
                <label class="form-label small">$a Institución</label>
                <input type="text" name="clasif_institucion" class="form-control" value="UNL" readonly disabled>
                <small class="text-muted">Copia del campo 040 $a</small>
            </div>
            <div class="col-md-6">
                <label class="form-label small">$b Proyecto</label>
                <input type="text" name="clasif_proyecto" class="form-control" value="BLMP" readonly disabled>
                <small class="text-muted">Predeterminado: BLMP</small>
            </div>
        </div>
        <div class="row g-3 mt-2">
            <div class="col-md-4">
                <label class="form-label small">$c País</label>
                <input type="text" name="clasif_pais" class="form-control" readonly disabled placeholder="Del campo 044 $a">
                <small class="text-muted">Copia del primer país (044 $a)</small>
            </div>
            <div class="col-md-4">
                <label class="form-label small">$d Ms/Imp</label>
                <input type="text" name="clasif_ms_imp" class="form-control" readonly disabled placeholder="Ms o Imp">
                <small class="text-muted">Según tipo de registro (Líder/06)</small>
            </div>
            <div class="col-md-4">
                <label class="form-label small">$0 Número de Control</label>
                <input type="text" name="clasif_num_control" class="form-control" readonly disabled placeholder="Del campo 001">
                <small class="text-muted">Copia del campo 001</small>
            </div>
        </div>
    </div>
</div>
