{# ============================================ #}
{# BLOQUE 1XX - ENTRADAS PRINCIPALES #}
{# ============================================ #}

<div class="card border-0 shadow-sm mb-4" id="bloque-1xx">
    <div class="card-body">
        <h2 class="section-title">Campos 1XX - Entradas Principales</h2>
        
        <!-- 100 - COMPOSITOR (con subcampos repetibles) -->
        <div class="campo-repetible">
            <div class="campo-header">
                <h3 class="campo-label mb-0">100 - Compositor</h3>
            </div>
            <div class="row g-3 mb-3">
                <div class="col-md-8">
                    <label class="form-label small">$a Apellidos, Nombres</label>
                    <div class="position-relative">
                        <input type="text" 
                               id="compositor_apellidos_nombres" 
                               name="compositor_apellidos_nombres" 
                               class="form-control" 
                               style="color: #222; background-color: #ffffe0; border-color: #97fcc9;"
                               placeholder="Ej: Beethoven, Ludwig van"
                               autocomplete="off">
                               <i class="bi bi-pencil position-absolute top-50 end-0 translate-middle-y me-2 text-success"></i>
                        <div id="compositor-autocomplete" class="autocomplete-dropdown"></div>
                    </div>
                </div>
                <div class="col-md-4">
                    <label class="form-label small">$d Fechas Asociadas</label>
                    <input type="text" 
                           id="compositor_fechas" 
                           name="compositor_fechas" 
                           class="form-control" 
                           placeholder="Ej: 1770-1827">
                </div>
            </div>

            <!-- Subcampo $e - Función (Repetible) -->
            <div class="subcampo-group">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <label class="subcampo-label mb-0">$e Función del Compositor</label>
                    <button type="button" class="btn btn-outline-primary btn-sm" onclick="agregarFuncionCompositor()">
                        <i class="bi bi-plus"></i> 
                    </button>
                </div>
                <div id="funciones-compositor">
                    <div class="mb-2" data-subcampo="funcion-compositor-0">
                        <div class="input-group input-group-sm">
                            <span class="input-group-text">$e</span>
                            <select name="funcion_compositor_e_0" class="form-select form-select-sm">
                                <option value="arreglista">Arreglista</option>
                                <option value="coeditor">Coeditor</option>
                                <option value="compilador">Compilador</option>
                                <option value="compositor" selected>Compositor</option>
                                <option value="copista">Copista</option>
                                <option value="dedicatario">Dedicatario</option>
                                <option value="editor">Editor</option>
                                <option value="prologuista">Prologuista</option>
                            </select>
                            <button type="button" class="btn btn-outline-danger" onclick="eliminarSubcampo('funcion-compositor-0')">
                                <i class="bi bi-x"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Subcampo $j - Atribución (NR - No Repetible) -->
            <div class="subcampo-group mt-3">
                <label class="subcampo-label mb-2">$j Calificador de Atribución <small class="text-muted">(NR - No Repetible)</small></label>
                <div class="input-group input-group-sm">
                    <span class="input-group-text">$j</span>
                    <select name="atribucion_compositor_j" class="form-select form-select-sm">
                        <option value="atribuida">Atribuida</option>
                        <option value="certificada" selected>Certificada</option>
                        <option value="erronea">Errónea</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- 130 - TÍTULO UNIFORME (con subcampos repetibles) -->
        <div class="campo-repetible">
            <div class="campo-header">
                <h3 class="campo-label mb-0">130 - Título Uniforme</h3>
            </div>
            
            <!-- <div class="alert alert-warning" role="alert">
                <i class="bi bi-exclamation-triangle"></i>
                <small>Usar solo cuando NO se haya ingresado compositor en el campo 100.</small>
            </div> -->
            
            <!-- Fila 1: $a (ancho completo) -->
            <div class="row g-3 mb-2">
                <div class="col-12">
                    <label class="form-label small">$a Título Uniforme</label>
                    <div class="position-relative">
                        <input type="text" 
                               id="titulo_uniforme_130" 
                               name="titulo_uniforme_130" 
                               class="form-control" 
                               style="color: #222; background-color: #ffffe0; border-color: #97fcc9;"
                               placeholder="Ej: Sinfonías"
                               autocomplete="off">
                               <i class="bi bi-pencil position-absolute top-50 end-0 translate-middle-y me-2 text-success"></i>
                        <div id="titulo-130-autocomplete" class="autocomplete-dropdown"></div>
                    </div>
                </div>
            </div>

            <!-- Fila 2: $k y $o (mismo espacio) -->
            <div class="row g-3 mb-2">
                <div class="col-md-6">
                    <!-- Subcampo $k - Forma (NR - No Repetible) -->
                    <div class="subcampo-group">
                        <label class="subcampo-label mb-2">$k Subencabezamiento de Forma <small class="text-muted">(NR - No Repetible)</small></label>
                        <div class="input-group input-group-sm">
                            <span class="input-group-text">$k</span>
                            <input type="text" 
                                   name="forma_130_k" 
                                   class="form-control" 
                                   placeholder="Ej: Selección, Fragmento">
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <label class="form-label small">$o Arreglo</label>
                    <input type="text" name="titulo_uniforme_arreglo" class="form-control" placeholder="Arreglo" value="arreglo">
                </div>
            </div>

            <!-- Fila 3: $m y $r ($m más largo) -->
            <div class="row g-3 mb-3">
                <div class="col-md-6">
                    <!-- Subcampo $m - Medio de Interpretación (NR - No Repetible) -->
                    <div class="subcampo-group">
                        <label class="subcampo-label mb-2">$m Medio de Interpretación para Música <small class="text-muted">(NR - No Repetible)</small></label>
                        <div class="input-group input-group-sm">
                            <span class="input-group-text">$m</span>
                            <input type="text" name="medio_interpretacion_130_m" class="form-control" placeholder="Ej: piano, orquesta">
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <label class="form-label small">$r Tonalidad</label>
                    <select name="titulo_uniforme_tonalidad" class="form-select">
                        <option value="">-- Seleccionar --</option>
                        {% for key, value in tonalidades %}
                        <option value="{{ key }}">{{ value }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>

            <!-- Fila 4: $n y $p (mismo espacio) -->
            <div class="row g-3">
                <div class="col-md-6">
                    <!-- Subcampo $n - Número de Parte/Sección (NR - No Repetible) -->
                    <div class="subcampo-group">
                        <label class="subcampo-label mb-2">$n Número de Parte/Sección <small class="text-muted">(NR - No Repetible)</small></label>
                        <div class="input-group input-group-sm">
                            <span class="input-group-text">$n</span>
                            <input type="text" name="numero_parte_130_n" class="form-control" placeholder="Ej: I, II, III o 1, 2, 3">
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <!-- Subcampo $p - Nombre de Parte/Sección (NR - No Repetible) -->
                    <div class="subcampo-group">
                        <label class="subcampo-label mb-2">$p Nombre de Parte/Sección <small class="text-muted">(NR - No Repetible)</small></label>
                        <div class="input-group input-group-sm">
                            <span class="input-group-text">$p</span>
                            <input type="text" name="nombre_parte_130_p" class="form-control" placeholder="Ej: Allegro, Andante, Finale">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 240 - TÍTULO UNIFORME CON COMPOSITOR -->
        <div class="campo-repetible">
            <div class="campo-header">
                <h3 class="campo-label mb-0">240 - Título Uniforme</h3>
            </div>
            <!-- <div class="alert alert-info" role="alert">
                <i class="bi bi-info-circle"></i>
                <small>Usar cuando SÍ existe compositor en el campo 100.</small>
            </div> -->
            
            <!-- Fila 1: $a (ancho completo) -->
            <div class="row g-3 mb-2">
                <div class="col-12">
                    <label class="form-label small">$a Título Uniforme</label>
                    <div class="position-relative">
                        <input type="text" 
                               id="titulo_240" 
                               name="titulo_240" 
                               class="form-control" 
                               placeholder="Ej: Conciertos"
                               autocomplete="off">
                        <div id="titulo-240-autocomplete" class="autocomplete-dropdown"></div>
                    </div>
                </div>
            </div>

            <!-- Fila 2: $k y $o (mismo espacio) -->
            <div class="row g-3 mb-2">
                <div class="col-md-6">
                    <!-- Subcampo $k - Forma (NR - No Repetible) -->
                    <div class="subcampo-group">
                        <label class="subcampo-label mb-2">$k Subencabezamiento de Forma <small class="text-muted">(NR - No Repetible)</small></label>
                        <div class="input-group input-group-sm">
                            <span class="input-group-text">$k</span>
                            <input type="text" 
                                   name="forma_240_k" 
                                   class="form-control" 
                                   placeholder="Ej: Selección, Fragmento">
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <label class="form-label small">$o Arreglo</label>
                    <input type="text" name="titulo_240_arreglo" class="form-control" placeholder="Arreglo" value="arreglo">
                </div>
            </div>

            <!-- Fila 3: $m y $r ($m más largo) -->
            <div class="row g-3 mb-3">
                <div class="col-md-8">
                    <!-- Subcampo $m - Medio de Interpretación (NR - No Repetible) -->
                    <div class="subcampo-group">
                        <label class="subcampo-label mb-2">$m Medio de Interpretación para Música <small class="text-muted">(NR - No Repetible)</small></label>
                        <div class="input-group input-group-sm">
                            <span class="input-group-text">$m</span>
                            <input type="text" name="medio_interpretacion_240_m" class="form-control" placeholder="Ej: piano, orquesta">
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <label class="form-label small">$r Tonalidad</label>
                    <select name="titulo_240_tonalidad" class="form-select">
                        <option value="">-- Seleccionar --</option>
                        {% for key, value in tonalidades %}
                        <option value="{{ key }}">{{ value }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>

            <!-- Fila 4: $n y $p (mismo espacio) -->
            <div class="row g-3">
                <div class="col-md-6">
                    <!-- Subcampo $n - Número de Parte/Sección (NR - No Repetible) -->
                    <div class="subcampo-group">
                        <label class="subcampo-label mb-2">$n Número de Parte/Sección <small class="text-muted">(NR - No Repetible)</small></label>
                        <div class="input-group input-group-sm">
                            <span class="input-group-text">$n</span>
                            <input type="text" name="numero_parte_240_n" class="form-control" placeholder="Ej: I, II, III o 1, 2, 3">
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <!-- Subcampo $p - Nombre de Parte/Sección (NR - No Repetible) -->
                    <div class="subcampo-group">
                        <label class="subcampo-label mb-2">$p Nombre de Parte/Sección <small class="text-muted">(NR - No Repetible)</small></label>
                        <div class="input-group input-group-sm">
                            <span class="input-group-text">$p</span>
                            <input type="text" name="nombre_parte_240_p" class="form-control" placeholder="Ej: Allegro, Andante, Finale">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
